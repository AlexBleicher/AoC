package AoC2023.Day16;

import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.Arguments;
import org.junit.jupiter.params.provider.MethodSource;

import java.util.stream.Stream;

import static org.junit.jupiter.api.Assertions.assertEquals;

class Day16Test {

    static Stream<Arguments> task1() {
        return Stream.of(
                Arguments.of(".|...\\....\n" +
                        "|.-.\\.....\n" +
                        ".....|-...\n" +
                        "........|.\n" +
                        "..........\n" +
                        ".........\\\n" +
                        "..../.\\\\..\n" +
                        ".-.-/..|..\n" +
                        ".|....-|.\\\n" +
                        "..//.|....", 46),
                Arguments.of("\\.............\\................\\....\\..../....\\/...............................\\...-..........-.\\.-....../....\n" +
                        "|\\......../|....\\..............-\\............./...........................-..........-......\\........\\........\n" +
                        ".......||......../....-./.../-...|.|..-......-.|....../................\\............|...................-..|..\n" +
                        "........./......-.............-\\......................|.\\./.......|........./......-......../..-.........|....\n" +
                        "....../....................-............................................../...../...|.........................\n" +
                        "....................\\....|/............................./.......-....|......../..........................\\....\n" +
                        ".|....../|.........-......|.............\\..|..................|......../.................|.|............-.|...\n" +
                        ".....-............\\\\............\\................/......-.........\\................\\..|../....................\n" +
                        "............|..|.......|......../................\\.......................|../....../......./.....|............\n" +
                        ".\\...........\\..\\.............../.........-/....|......................./.....-./-.........../-........-......\n" +
                        "|................\\.\\-.............../..-............./........./.................\\.............|...-.....-....\n" +
                        ".........-....|..|......................................\\.||...-../..|............../...../.../.........-.....\n" +
                        ".....-....-\\.................|...........|../.....\\...............................|...../../|.................\n" +
                        ".\\......\\......................\\....../.../.....-.../.........................../..|...........|..\\...........\n" +
                        "-............|.........-.-........-.........................|...\\...-...........\\.|...-....../..........|.....\n" +
                        ".........-.......|......\\.....\\..-...../..../.....\\.../............/..........-......./....../...........\\.../\n" +
                        "..............\\........................|.............................-../......-..-...../..................\\..\n" +
                        ".....\\......-.......-.......-......../../../........\\.......-..........|......./........................../...\n" +
                        ".\\...\\...................|./\\|.-..\\...............................\\..\\.....-....|......................./.....\n" +
                        ".................-...|....|.../...../.|.||.....-.|............................-..............\\................\n" +
                        "........................................../.......................|........\\......../.../..............|.....\\\n" +
                        ".......\\......./............................./........../../..........................-\\..................|...\n" +
                        "...........-...|..\\..........-.........\\.................././................|./.......|............../.......\n" +
                        "......./..................................\\...-.........\\........\\....../............................\\......\\-\n" +
                        "-.|..-|...............|..........................\\..........|.-.........\\............-.|.............\\.....|..\n" +
                        ".............................../..............-.....-.......-........................|.......-................\n" +
                        ".........\\.........-.........|...../......../......./....-...\\...................\\........\\...................\n" +
                        "..........\\.........\\........../...|.................|./...\\.......\\..........-...............................\n" +
                        "./...................|........../\\......../....................|..-...........\\...\\...........|..............|\n" +
                        ".....|...........\\-.\\.......-..........................-....-...................|....|.|...............-......\n" +
                        ".|.././......................|.......|.......|..............\\...../.................../.\\...-.................\n" +
                        "...........-........./....|.................|..-.....-............./...................................-..../.\n" +
                        "...................\\/..|.....-............../-......-..........|........................./...\\....-|....|-....\n" +
                        "........................./..-..|.\\-...............-......-/...../.......\\..|................-...\\.|.....\\.....\n" +
                        "\\...../.........................../....................-..........|........../..-..-.......\\........../.././|.\n" +
                        "........................../...\\|..................................................../...|.-........-.....|..\\.\n" +
                        "....\\.............................|./.....|...../....\\.............\\...../.......-...............\\..-..../....\n" +
                        ".........-.........................|................|........\\/.\\-...................\\..-......./../..........\n" +
                        "...-.../............/.................-..........\\....../............../...../..........|.....................\n" +
                        "..........\\...\\..................|...-......\\\\......./...-.............-\\.................|...../......\\......\n" +
                        "/..\\/.............\\....\\.............\\.......................................|.....\\....-............\\........\n" +
                        "....../..\\.|................................\\.........../.......-.......-/.....|...................-.....-....\n" +
                        "........-....|.............................|....../...............\\.......................--..................\n" +
                        "................/......|.........-....................-..............|.......................................|\n" +
                        ".........\\........|...........................\\.............|.............................../.................\n" +
                        "...|..\\....-......../.\\...-............................................................/....-...../...........\n" +
                        ".............\\\\\\.../...../.../..........\\..............\\...........\\........................|....../.........\\\n" +
                        "......-..............|..-..|....-\\..\\..-...-............\\.................\\...-.\\/.....\\......-.\\....--.../...\n" +
                        "........./...................../...../..|...\\.\\/.........\\.../........................................\\.../-..\n" +
                        "........\\.......|.......|\\..|........../..../\\........../........\\..../..............././..../.............-.\\\n" +
                        "........................|-............|............................./.-.|...|............../....-\\............\n" +
                        "../........-.../....................|....................-/.............../.....-...........-....\\......||....\n" +
                        ".....\\..|.....-|../....|./....-|.......-...../..-..\\..............\\...................../.................|...\n" +
                        "...-......../.\\...........\\.........\\../.....|............\\..................../.........\\................/.\\/\n" +
                        "...../...|............-..\\.../............/............-..............--.-..........././............-........|\n" +
                        ".....|...........\\.....-...\\..../.....-........-.....\\.|..............\\....-............./...../..............\n" +
                        "....\\.....-.|....\\..../..............\\|../.........../......|....\\/.......................|............|....-.\n" +
                        "........|..--..............|..............-........|.......|.-.........\\.............-...........\\............\n" +
                        "./.||....\\......./....\\./........../...........././....\\.................../..................\\...../.........\n" +
                        ".......|..\\...-.\\..\\..|.........../..................................-....|........\\......|....|..............\n" +
                        "...|..........|.........-...............|...............................-.......|...........-..\\.......\\......\n" +
                        ".\\.........../../............................-..|...\\.....-.........../......-|.../.....|.................-...\n" +
                        "........|....../..\\..\\|..|......|.........|...............................\\../.....\\....-/........-...........\n" +
                        ".................................................\\.......|........|.\\.-....../.......|.......|............\\...\n" +
                        ".......|.......\\.......|.........|......-......|...|...\\.............\\.............|/.........................\n" +
                        "..........|....................|..........\\..........-......./................................................\n" +
                        "...../.......|....................|......................././.................................................\n" +
                        "........\\.............|........--..........\\.............../......|...................../............|..\\.....\n" +
                        "....-............|.........|....|.-.\\../-...\\....-...-................\\|..\\-.......|........-............../..\n" +
                        "................/........\\.....\\.....././....|....................-...............\\...........-......\\........\n" +
                        ".\\.....|......|...|\\......\\.\\/....\\.............-............\\.....\\.......-...-........-....//..../.....|..-.\n" +
                        "..................|..|.-.................../\\...........|..../..........\\|.....-..|.../.......................\n" +
                        "-......-......./........./../.............../..................-..\\.......\\............|...../../....../......\n" +
                        "....../............/...........\\.............\\............./.........../.......\\......|....|.........../......\n" +
                        "...\\........|..................|............-............-.....-..\\..-................/........../........||..\n" +
                        "......../..|..-../..../......................../.........\\./.-................../...................-.........\n" +
                        ".../....|....\\.......-..\\..........-....\\.............|\\........../...............-........|..................\n" +
                        "..............\\.............\\|.........-......................-........\\|......./.......-.................|...\n" +
                        "/..../...-||\\-...|\\...............................\\.......................\\.............-................-....\n" +
                        ".......-..-....|..................|..............................................................///...-.../.|\n" +
                        "......|.......-/........-.-......|....\\..-...|...........\\...........\\.....................-..../.........../.\n" +
                        "......-...........|-..\\.......|...|.\\|.................-....\\...................\\.\\........\\.\\./.........\\....\n" +
                        "....../............../.........|...|.......|..../.............................................................\n" +
                        ".........../...................-./...\\..........\\-............./...........\\.../.....|......................-.\n" +
                        "/..../..../........................................|.\\......-/......./....\\.........................-......|..\n" +
                        ".\\./.|.-..........................|...|...........|....../....-....../|...............\\..............\\...-....\n" +
                        "....|...\\..........|......-..................|........../..|.-...\\........./........|................|........\n" +
                        "...\\....\\........../........../.........\\..............-...........................-.|...../..........\\.......\n" +
                        "...|...........-...........................\\........-.........................\\...-..-.....\\.......|........-.\n" +
                        "......\\|...........................\\.....................................-............/....\\...........|......\n" +
                        "................../............-........................\\.................................................-...\n" +
                        ".../....|...............|....................../\\.........|....................\\....|............\\.........|-.\n" +
                        ".......................................|....-.........../....\\-........|......./............-..|.............\\\n" +
                        "/.........\\..\\.........|...............\\.......\\........./................\\....................|.....|........\n" +
                        "..................................|.....|.-..|.../......................../-\\......|..........................\n" +
                        ".................|.....................................................-............|.....|..../.\\/..........|\n" +
                        ".......\\....\\....-........|.|..../......-......\\...../....................-...........\\............-..........\n" +
                        "....-.................................-..........-......-................................../.........-\\...|...\n" +
                        ".....................|......................|.........-............../.../.....-........\\.....................\n" +
                        ".\\./..........-.\\...\\||................./../........\\.........|...\\........\\....\\.\\...............-|......|...\n" +
                        "..\\......//.........../.\\........\\......|......|........\\......\\.....-..........|.-..|...../|.................\n" +
                        "/.....................\\.................-........|...................\\.....-..............-/.....\\..|../../...\n" +
                        "...|..-.../............./.|.................../............/..\\...........-....|-............\\.......--.......\n" +
                        "..............\\..\\/.....\\.........|.\\.........................|............|........./................./-..|-.\n" +
                        "...........................-.................../...................|\\..........\\/..|.-........................\n" +
                        ".....-.............................../....................\\.........|......................|..................\n" +
                        "..................\\.........../...........\\..\\/.........|...........|..-........|....\\..........-...../.|.....\n" +
                        "..........|.......\\..\\...........\\.../......................-...........-.....-........../\\|..................\n" +
                        "....../.......-........................\\|...//...\\..-......\\.......|..\\....................-..........\\..-....\n" +
                        "|./....|........-./........../.\\...\\.....|../..../.......-........../.\\.....-.................................\n", 0)
        );
    }

    static Stream<Arguments> task2() {
        return Stream.of(
                Arguments.of(".|...\\....\n" +
                        "|.-.\\.....\n" +
                        ".....|-...\n" +
                        "........|.\n" +
                        "..........\n" +
                        ".........\\\n" +
                        "..../.\\\\..\n" +
                        ".-.-/..|..\n" +
                        ".|....-|.\\\n" +
                        "..//.|....", 51),
                Arguments.of("\\.............\\................\\....\\..../....\\/...............................\\...-..........-.\\.-....../....\n" +
                        "|\\......../|....\\..............-\\............./...........................-..........-......\\........\\........\n" +
                        ".......||......../....-./.../-...|.|..-......-.|....../................\\............|...................-..|..\n" +
                        "........./......-.............-\\......................|.\\./.......|........./......-......../..-.........|....\n" +
                        "....../....................-............................................../...../...|.........................\n" +
                        "....................\\....|/............................./.......-....|......../..........................\\....\n" +
                        ".|....../|.........-......|.............\\..|..................|......../.................|.|............-.|...\n" +
                        ".....-............\\\\............\\................/......-.........\\................\\..|../....................\n" +
                        "............|..|.......|......../................\\.......................|../....../......./.....|............\n" +
                        ".\\...........\\..\\.............../.........-/....|......................./.....-./-.........../-........-......\n" +
                        "|................\\.\\-.............../..-............./........./.................\\.............|...-.....-....\n" +
                        ".........-....|..|......................................\\.||...-../..|............../...../.../.........-.....\n" +
                        ".....-....-\\.................|...........|../.....\\...............................|...../../|.................\n" +
                        ".\\......\\......................\\....../.../.....-.../.........................../..|...........|..\\...........\n" +
                        "-............|.........-.-........-.........................|...\\...-...........\\.|...-....../..........|.....\n" +
                        ".........-.......|......\\.....\\..-...../..../.....\\.../............/..........-......./....../...........\\.../\n" +
                        "..............\\........................|.............................-../......-..-...../..................\\..\n" +
                        ".....\\......-.......-.......-......../../../........\\.......-..........|......./........................../...\n" +
                        ".\\...\\...................|./\\|.-..\\...............................\\..\\.....-....|......................./.....\n" +
                        ".................-...|....|.../...../.|.||.....-.|............................-..............\\................\n" +
                        "........................................../.......................|........\\......../.../..............|.....\\\n" +
                        ".......\\......./............................./........../../..........................-\\..................|...\n" +
                        "...........-...|..\\..........-.........\\.................././................|./.......|............../.......\n" +
                        "......./..................................\\...-.........\\........\\....../............................\\......\\-\n" +
                        "-.|..-|...............|..........................\\..........|.-.........\\............-.|.............\\.....|..\n" +
                        ".............................../..............-.....-.......-........................|.......-................\n" +
                        ".........\\.........-.........|...../......../......./....-...\\...................\\........\\...................\n" +
                        "..........\\.........\\........../...|.................|./...\\.......\\..........-...............................\n" +
                        "./...................|........../\\......../....................|..-...........\\...\\...........|..............|\n" +
                        ".....|...........\\-.\\.......-..........................-....-...................|....|.|...............-......\n" +
                        ".|.././......................|.......|.......|..............\\...../.................../.\\...-.................\n" +
                        "...........-........./....|.................|..-.....-............./...................................-..../.\n" +
                        "...................\\/..|.....-............../-......-..........|........................./...\\....-|....|-....\n" +
                        "........................./..-..|.\\-...............-......-/...../.......\\..|................-...\\.|.....\\.....\n" +
                        "\\...../.........................../....................-..........|........../..-..-.......\\........../.././|.\n" +
                        "........................../...\\|..................................................../...|.-........-.....|..\\.\n" +
                        "....\\.............................|./.....|...../....\\.............\\...../.......-...............\\..-..../....\n" +
                        ".........-.........................|................|........\\/.\\-...................\\..-......./../..........\n" +
                        "...-.../............/.................-..........\\....../............../...../..........|.....................\n" +
                        "..........\\...\\..................|...-......\\\\......./...-.............-\\.................|...../......\\......\n" +
                        "/..\\/.............\\....\\.............\\.......................................|.....\\....-............\\........\n" +
                        "....../..\\.|................................\\.........../.......-.......-/.....|...................-.....-....\n" +
                        "........-....|.............................|....../...............\\.......................--..................\n" +
                        "................/......|.........-....................-..............|.......................................|\n" +
                        ".........\\........|...........................\\.............|.............................../.................\n" +
                        "...|..\\....-......../.\\...-............................................................/....-...../...........\n" +
                        ".............\\\\\\.../...../.../..........\\..............\\...........\\........................|....../.........\\\n" +
                        "......-..............|..-..|....-\\..\\..-...-............\\.................\\...-.\\/.....\\......-.\\....--.../...\n" +
                        "........./...................../...../..|...\\.\\/.........\\.../........................................\\.../-..\n" +
                        "........\\.......|.......|\\..|........../..../\\........../........\\..../..............././..../.............-.\\\n" +
                        "........................|-............|............................./.-.|...|............../....-\\............\n" +
                        "../........-.../....................|....................-/.............../.....-...........-....\\......||....\n" +
                        ".....\\..|.....-|../....|./....-|.......-...../..-..\\..............\\...................../.................|...\n" +
                        "...-......../.\\...........\\.........\\../.....|............\\..................../.........\\................/.\\/\n" +
                        "...../...|............-..\\.../............/............-..............--.-..........././............-........|\n" +
                        ".....|...........\\.....-...\\..../.....-........-.....\\.|..............\\....-............./...../..............\n" +
                        "....\\.....-.|....\\..../..............\\|../.........../......|....\\/.......................|............|....-.\n" +
                        "........|..--..............|..............-........|.......|.-.........\\.............-...........\\............\n" +
                        "./.||....\\......./....\\./........../...........././....\\.................../..................\\...../.........\n" +
                        ".......|..\\...-.\\..\\..|.........../..................................-....|........\\......|....|..............\n" +
                        "...|..........|.........-...............|...............................-.......|...........-..\\.......\\......\n" +
                        ".\\.........../../............................-..|...\\.....-.........../......-|.../.....|.................-...\n" +
                        "........|....../..\\..\\|..|......|.........|...............................\\../.....\\....-/........-...........\n" +
                        ".................................................\\.......|........|.\\.-....../.......|.......|............\\...\n" +
                        ".......|.......\\.......|.........|......-......|...|...\\.............\\.............|/.........................\n" +
                        "..........|....................|..........\\..........-......./................................................\n" +
                        "...../.......|....................|......................././.................................................\n" +
                        "........\\.............|........--..........\\.............../......|...................../............|..\\.....\n" +
                        "....-............|.........|....|.-.\\../-...\\....-...-................\\|..\\-.......|........-............../..\n" +
                        "................/........\\.....\\.....././....|....................-...............\\...........-......\\........\n" +
                        ".\\.....|......|...|\\......\\.\\/....\\.............-............\\.....\\.......-...-........-....//..../.....|..-.\n" +
                        "..................|..|.-.................../\\...........|..../..........\\|.....-..|.../.......................\n" +
                        "-......-......./........./../.............../..................-..\\.......\\............|...../../....../......\n" +
                        "....../............/...........\\.............\\............./.........../.......\\......|....|.........../......\n" +
                        "...\\........|..................|............-............-.....-..\\..-................/........../........||..\n" +
                        "......../..|..-../..../......................../.........\\./.-................../...................-.........\n" +
                        ".../....|....\\.......-..\\..........-....\\.............|\\........../...............-........|..................\n" +
                        "..............\\.............\\|.........-......................-........\\|......./.......-.................|...\n" +
                        "/..../...-||\\-...|\\...............................\\.......................\\.............-................-....\n" +
                        ".......-..-....|..................|..............................................................///...-.../.|\n" +
                        "......|.......-/........-.-......|....\\..-...|...........\\...........\\.....................-..../.........../.\n" +
                        "......-...........|-..\\.......|...|.\\|.................-....\\...................\\.\\........\\.\\./.........\\....\n" +
                        "....../............../.........|...|.......|..../.............................................................\n" +
                        ".........../...................-./...\\..........\\-............./...........\\.../.....|......................-.\n" +
                        "/..../..../........................................|.\\......-/......./....\\.........................-......|..\n" +
                        ".\\./.|.-..........................|...|...........|....../....-....../|...............\\..............\\...-....\n" +
                        "....|...\\..........|......-..................|........../..|.-...\\........./........|................|........\n" +
                        "...\\....\\........../........../.........\\..............-...........................-.|...../..........\\.......\n" +
                        "...|...........-...........................\\........-.........................\\...-..-.....\\.......|........-.\n" +
                        "......\\|...........................\\.....................................-............/....\\...........|......\n" +
                        "................../............-........................\\.................................................-...\n" +
                        ".../....|...............|....................../\\.........|....................\\....|............\\.........|-.\n" +
                        ".......................................|....-.........../....\\-........|......./............-..|.............\\\n" +
                        "/.........\\..\\.........|...............\\.......\\........./................\\....................|.....|........\n" +
                        "..................................|.....|.-..|.../......................../-\\......|..........................\n" +
                        ".................|.....................................................-............|.....|..../.\\/..........|\n" +
                        ".......\\....\\....-........|.|..../......-......\\...../....................-...........\\............-..........\n" +
                        "....-.................................-..........-......-................................../.........-\\...|...\n" +
                        ".....................|......................|.........-............../.../.....-........\\.....................\n" +
                        ".\\./..........-.\\...\\||................./../........\\.........|...\\........\\....\\.\\...............-|......|...\n" +
                        "..\\......//.........../.\\........\\......|......|........\\......\\.....-..........|.-..|...../|.................\n" +
                        "/.....................\\.................-........|...................\\.....-..............-/.....\\..|../../...\n" +
                        "...|..-.../............./.|.................../............/..\\...........-....|-............\\.......--.......\n" +
                        "..............\\..\\/.....\\.........|.\\.........................|............|........./................./-..|-.\n" +
                        "...........................-.................../...................|\\..........\\/..|.-........................\n" +
                        ".....-.............................../....................\\.........|......................|..................\n" +
                        "..................\\.........../...........\\..\\/.........|...........|..-........|....\\..........-...../.|.....\n" +
                        "..........|.......\\..\\...........\\.../......................-...........-.....-........../\\|..................\n" +
                        "....../.......-........................\\|...//...\\..-......\\.......|..\\....................-..........\\..-....\n" +
                        "|./....|........-./........../.\\...\\.....|../..../.......-........../.\\.....-.................................\n", 0)
        );
    }

    @ParameterizedTest
    @MethodSource
    void task1(String i, long expected) {
        Day16 test = new Day16(i);
        long actual = test.task1();
        assertEquals(expected, actual);
    }

    @ParameterizedTest
    @MethodSource
    void task2(String i, long expected) {
        Day16 test = new Day16(i);
        long actual = test.task2();
        assertEquals(expected, actual);
    }
}